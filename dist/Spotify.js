"use strict";var __importDefault=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(exports,"__esModule",{value:!0});const Error_1=require("./Error"),axios_1=__importDefault(require("axios")),spotify_uri_info_1=__importDefault(require("@spotify-api.js/spotify-uri-info"));class default_1{constructor(t){this.token=t}hexToRgb(t){if("string"==typeof t&&/^([0-9A-F]{3}){1,2}$/i.test(t))throw new Error_1.UtilityError("Invalid hex code provided!");let e=1;8===(t=t.replace(/^#/,"")).length&&(e=parseInt(t.slice(6,8),16)/255,t=t.slice(0,6)),4===t.length&&(e=parseInt(t.slice(3,4).repeat(2),16)/255,t=t.slice(0,3)),3===t.length&&(t=t[0]+t[0]+t[1]+t[1]+t[2]+t[2]);const r=parseInt(t,16);return[r>>16,r>>8&255,255&r,e]}async fetch(t){const{data:e}=await axios_1.default.get("https://api.spotify.com/"+t.link,{headers:t.headers||{Authorization:"Bearer "+this.token},params:t.params||{}});return e}async getURIData(t){return new Promise((async(e,r)=>{try{e(await spotify_uri_info_1.default.getData(t))}catch(t){r(t)}}))}async getCodeImage(t){const e=await this.getURIData(t);let r=this.hexToRgb(e.dominantColor);return{image:`https://scannables.scdn.co/uri/plain/jpeg/${e.dominantColor.slice(1)}/${r[0]>150?"black":"white"}/1080/${t}`,dominantColor:{hex:e.dominantColor,rgb:r}}}}exports.default=default_1;
