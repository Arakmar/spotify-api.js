"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
const Errors_1 = require("./Errors");
const Util_1 = __importDefault(require("./Util"));
/**
 * A class which accesses the current user endpoints!
 */
class UserClient {
    /**
     * The same client but manages current user endpoints and requires a current user api token not a token which is generated by client and client secret
     *
     * @param token Your spotify current user token!
     * @example const user = new UserClient('token');
     */
    constructor(token) {
        this.token = token;
        this.name = '';
        this.country = '';
        this.email = 'unknown';
        this.externalUrls = {};
        this.totalFollowers = 0;
        this.product = 'unknown';
        this.images = [];
        this.uri = '';
        this.id = '';
        this.href = '';
        Object.defineProperty(this, 'util', { value: new Util_1.default(token) });
    }
    /**
     * Returns current user details
     *
     * @example const user = await user.me();
     */
    async me() {
        try {
            const data = await this.util.fetch('/me');
            this.name = data.display_name;
            this.country = data.country || 'unknown';
            this.id = data.id;
            this.email = data.email || 'unknown';
            this.externalUrls = data.external_urls;
            this.totalFollowers = data.followers.total;
            this.href = data.href;
            this.images = data.images;
            this.product = data.product || 'unknown';
            this.uri = data.uri;
        }
        catch (e) {
            throw new Errors_1.UnexpectedError(e);
        }
        return this;
    }
}
exports.default = UserClient;
;
